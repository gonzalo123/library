/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["../library","sap/ui/base/Object","sap/ui/core/library","sap/ui/table/utils/TableUtils","sap/ui/unified/Menu","sap/ui/unified/MenuItem"],function(e,t,o,s,n,u){"use strict";const i=e.GroupEventType;const l=["ungroup","collapse","expand"];const r=t.extend("sap.ui.table.menus.GroupHeaderContextMenuAdapter",{constructor:function(e){this._oTable=e;this._mItems=new Map}});r.prototype.addItemsTo=function(e,t){if(!this._mItems.size){this._createItems()}for(const[o,s]of this._mItems.entries()){if(!l.includes(o)){s.setVisible(!!t)}if(!e.getItems().includes(s)){e.addItem(s)}}if(!t){return}const{column:o,index:n}=this._getGroupedColumnInfo();const[u,i]=this._mItems.get("move").getSubmenu().getItems();const r=this._mItems.get("visibility");if(o){if(o.getShowIfGrouped()){r.setText(s.getResourceText("TBL_HIDE_COLUMN"))}else{r.setText(s.getResourceText("TBL_SHOW_COLUMN"))}u.setEnabled(n>0);i.setEnabled(n<this._oTable._aGroupedColumns.length-1)}else{u.setEnabled(true);i.setEnabled(true)}};r.prototype.removeItemsFrom=function(e){if(!this._mItems.size){return}for(const t of this._mItems.values()){e.removeItem(t)}};r.prototype.destroy=function(){this._mItems?.forEach(e=>e.destroy());this._mItems?.clear();this._mItems=null;this._oTable=null};r.prototype._createItems=function(){const e=this._oTable;this._mItems.set("ungroup",new u({text:s.getResourceText("TBL_UNGROUP"),submenu:[new n({items:[new u({text:s.getResourceText("TBL_UNGROUP_LEVEL"),select:()=>{const{column:t}=this._getGroupedColumnInfo();if(t){t.setGrouped(false);e.fireGroup({column:t,groupedColumns:e._aGroupedColumns,type:i.ungroup})}}}),new u({text:s.getResourceText("TBL_UNGROUP_ALL"),select:()=>{e.suspendUpdateAnalyticalInfo();for(const t of e.getColumns()){t.setGrouped(false)}e.resumeUpdateAnalyticalInfo();e.fireGroup({column:undefined,groupedColumns:[],type:i.ungroupAll})}})]})]}));this._mItems.set("collapse",new u({text:s.getResourceText("TBL_COLLAPSE"),icon:"sap-icon://collapse-all",submenu:[new n({items:[new u({text:s.getResourceText("TBL_COLLAPSE_LEVEL"),select:()=>{e.getBinding().collapseToLevel(e._iGroupedLevel-1);e.setFirstVisibleRow(0);e._getSelectionPlugin().clearSelection()}}),new u({text:s.getResourceText("TBL_COLLAPSE_ALL"),select:()=>{e.getBinding().collapseToLevel(0);e.setFirstVisibleRow(0);e._getSelectionPlugin().clearSelection()}})]})]}));this._mItems.set("expand",new u({text:s.getResourceText("TBL_EXPAND"),icon:"sap-icon://expand-all",submenu:[new n({items:[new u({text:s.getResourceText("TBL_EXPAND_LEVEL"),select:()=>{e.getBinding().expandToLevel(e._iGroupedLevel);e.setFirstVisibleRow(0);e._getSelectionPlugin().clearSelection()}}),new u({text:s.getResourceText("TBL_EXPAND_ALL"),select:()=>{e.expandAll()}})]})]}));this._mItems.set("visibility",new u({text:s.getResourceText("TBL_SHOW_COLUMN"),select:()=>{const{column:t}=this._getGroupedColumnInfo();if(t){const o=t.getShowIfGrouped();t.setShowIfGrouped(!o);e.fireGroup({column:t,groupedColumns:e._aGroupedColumns,type:!o?i.showGroupedColumn:i.hideGroupedColumn})}}}));this._mItems.set("move",new u({text:s.getResourceText("TBL_MOVE"),submenu:[new n({items:[new u({text:s.getResourceText("TBL_MOVE_UP"),icon:"sap-icon://arrow-top",select:()=>{const{column:t,index:o}=this._getGroupedColumnInfo();if(t&&o>0){e._aGroupedColumns[o]=e._aGroupedColumns.splice(o-1,1,e._aGroupedColumns[o])[0];e.updateAnalyticalInfo();e.fireGroup({column:t,groupedColumns:e._aGroupedColumns,type:i.moveUp})}}}),new u({text:s.getResourceText("TBL_MOVE_DOWN"),icon:"sap-icon://arrow-bottom",select:()=>{const{column:t,index:o}=this._getGroupedColumnInfo();if(t&&o<e._aGroupedColumns.length){e._aGroupedColumns[o]=e._aGroupedColumns.splice(o+1,1,e._aGroupedColumns[o])[0];e.updateAnalyticalInfo();e.fireGroup({column:t,groupedColumns:e._aGroupedColumns,type:i.moveDown})}}})]})]}));this._mItems.set("sort",new u({text:s.getResourceText("TBL_SORT"),icon:"sap-icon://sort",submenu:[new n({items:[new u({text:s.getResourceText("TBL_SORT_ASC"),icon:"sap-icon://sort-ascending",select:()=>{this._getGroupedColumnInfo().column?._sort(o.SortOrder.Ascending)}}),new u({text:s.getResourceText("TBL_SORT_DESC"),icon:"sap-icon://sort-descending",select:()=>{this._getGroupedColumnInfo().column?._sort(o.SortOrder.Descending)}})]})]}))};r.prototype._getGroupedColumnInfo=function(){const e=this._oTable;const t=e._iGroupedLevel-1;const o=e.getColumns().find(function(o){return e._aGroupedColumns[t]===o.getId()});return{column:o,index:t}};return r});
//# sourceMappingURL=GroupHeaderContextMenuAdapter.js.map